<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پرداخت | ارزان کالا</title>
    <style>
        /* ===== استایل‌های پایه (مشترک) ===== */
        *{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,'Segoe UI',Roboto,'Helvetica Neue',sans-serif}
        body{background-color:#0a0c0b;color:#fff;overflow-x:hidden}
        :root{
            --primary:#00c853;
            --primary-dark:#008040;
            --bg-dark:#0a0c0b;
            --bg-card:#1a1e1d;
            --bg-nav:#050606;
            --border:#2a2f2e;
            --text-light:#e0e0e0;
            --text-muted:#a0a0a0;
            --danger:#ff5252;
            --warning:#ffc107;
            --shadow:0 10px 30px rgba(0,200,83,0.2);
        }
        /* ===== نوار بالایی (منوی اصلی) ===== */
        .navbar{
            position:fixed;
            top:0;
            left:0;
            width:100%;
            background:var(--bg-nav);
            border-bottom:3px solid var(--primary-dark);
            padding:0.8rem 2rem;
            z-index:10000;
            display:flex;
            align-items:center;
            justify-content:space-between;
            box-shadow:0 2px 20px rgba(0,200,83,0.2);
        }
        .navbar-brand{
            color:var(--primary);
            font-size:1.8rem;
            font-weight:800;
            text-decoration:none;
            display:flex;
            align-items:center;
            gap:10px;
            letter-spacing:1px;
        }
        .nav-menu{
            display:flex;
            align-items:center;
            gap:1rem;
            list-style:none;
            margin:0;
            padding:0;
        }
        .nav-item{
            position:relative;
        }
        .nav-link{
            color:var(--text-light);
            text-decoration:none;
            padding:0.6rem 1.2rem;
            border-radius:30px;
            font-weight:500;
            transition:all 0.3s;
            display:flex;
            align-items:center;
            gap:8px;
            white-space:nowrap;
        }
        .nav-link i{
            color:var(--primary);
            font-size:1.1rem;
        }
        .nav-link:hover{
            background:rgba(0,200,83,0.15);
            color:var(--primary);
            transform:translateY(-2px);
        }
        .dropdown-menu{
            position:absolute;
            top:100%;
            right:0;
            background:var(--bg-card);
            border:1px solid var(--primary);
            border-radius:20px;
            padding:0.8rem;
            min-width:220px;
            display:none;
            z-index:1000;
            box-shadow:var(--shadow);
            backdrop-filter:blur(10px);
        }
        .dropdown:hover .dropdown-menu{
            display:block;
            animation:fadeIn 0.3s;
        }
        @keyframes fadeIn{
            from{opacity:0;transform:translateY(-10px);}
            to{opacity:1;transform:translateY(0);}
        }
        .dropdown-item{
            color:var(--text-light);
            padding:0.8rem 1rem;
            text-decoration:none;
            display:block;
            border-radius:12px;
            transition:0.2s;
        }
        .dropdown-item:hover{
            background:rgba(0,200,83,0.15);
            color:var(--primary);
            padding-right:1.5rem;
        }
        .nav-tools{
            display:flex;
            align-items:center;
            gap:1rem;
        }
        .search-box{
            position:relative;
            width:250px;
        }
        .search-box input{
            width:100%;
            background:var(--bg-card);
            border:1px solid var(--border);
            border-radius:40px;
            padding:0.7rem 1rem 0.7rem 3rem;
            color:#fff;
            outline:none;
            transition:0.3s;
        }
        .search-box input:focus{
            border-color:var(--primary);
            box-shadow:0 0 0 3px rgba(0,200,83,0.2);
        }
        .search-box button{
            position:absolute;
            left:12px;
            top:50%;
            transform:translateY(-50%);
            background:none;
            border:none;
            color:var(--primary);
            font-size:1.2rem;
            cursor:pointer;
        }
        .cart-btn{
            background:var(--bg-card);
            border:none;
            border-radius:50%;
            width:48px;
            height:48px;
            color:var(--primary);
            font-size:1.3rem;
            cursor:pointer;
            transition:0.3s;
            position:relative;
            display:flex;
            align-items:center;
            justify-content:center;
        }
        .cart-btn:hover{
            background:#232827;
            transform:scale(1.1);
        }
        .badge{
            position:absolute;
            top:-5px;
            right:-5px;
            background:var(--primary);
            color:#fff;
            border-radius:50px;
            padding:3px 8px;
            font-size:0.7rem;
            font-weight:bold;
            min-width:22px;
            text-align:center;
        }
        .login-btn{
            background:var(--bg-card);
            border:2px solid var(--primary);
            border-radius:50%;
            width:48px;
            height:48px;
            display:flex;
            align-items:center;
            justify-content:center;
            color:var(--primary);
            text-decoration:none;
            transition:0.3s;
            font-size:1.2rem;
        }
        .login-btn:hover{
            background:var(--primary);
            color:#fff;
            transform:scale(1.1);
        }
        .hamburger{
            display:none;
            background:var(--bg-card);
            border:none;
            border-radius:50%;
            width:48px;
            height:48px;
            color:var(--primary);
            font-size:1.5rem;
            cursor:pointer;
            transition:0.3s;
            align-items:center;
            justify-content:center;
        }
        .mobile-menu{
            position:fixed;
            top:70px;
            left:0;
            width:100%;
            height:calc(100vh - 70px);
            background:var(--bg-nav);
            z-index:9999;
            padding:2rem;
            display:flex;
            flex-direction:column;
            gap:1.5rem;
            transform:translateX(100%);
            transition:transform 0.4s ease;
            overflow-y:auto;
            border-top:2px solid var(--primary);
        }
        .mobile-menu.active{
            transform:translateX(0);
        }
        .mobile-menu .nav-link{
            font-size:1.3rem;
            padding:1rem;
            border-bottom:1px solid var(--border);
            width:100%;
        }
        .mobile-menu .dropdown-menu{
            position:static;
            display:block;
            background:transparent;
            border:none;
            box-shadow:none;
            padding:0.5rem 2rem;
        }
        /* ===== سبد خرید کشویی ===== */
        .cart-wrapper{
            position:fixed;
            top:80px;
            left:20px;
            width:380px;
            z-index:9998;
            visibility:hidden;
            opacity:0;
            transform:translateY(-20px);
            transition:0.3s;
            pointer-events:none;
        }
        .cart-wrapper.active{
            visibility:visible;
            opacity:1;
            transform:translateY(0);
            pointer-events:auto;
        }
        .cart{
            background:var(--bg-card);
            border:2px solid var(--primary);
            border-radius:24px;
            box-shadow:var(--shadow);
            overflow:hidden;
        }
        .cart-header{
            background:linear-gradient(145deg,var(--primary),var(--primary-dark));
            padding:1.2rem;
        }
        .cart-body{
            padding:1.2rem;
            max-height:400px;
            overflow-y:auto;
        }
        .cart-item{
            display:flex;
            gap:12px;
            background:#0d0f0e;
            border-radius:16px;
            padding:12px;
            margin-bottom:12px;
            align-items:center;
        }
        .cart-item img{
            width:60px;
            height:60px;
            object-fit:contain;
            background:#0a0c0b;
            border-radius:12px;
            padding:5px;
        }
        .cart-item-info{
            flex:1;
        }
        .cart-item-name{
            font-weight:700;
            margin-bottom:4px;
        }
        .cart-item-price{
            color:var(--primary);
            font-weight:600;
        }
        .cart-qty{
            display:flex;
            align-items:center;
            gap:8px;
            margin-top:8px;
        }
        .qty-btn{
            background:transparent;
            border:1px solid var(--primary);
            color:var(--primary);
            width:28px;
            height:28px;
            border-radius:6px;
            cursor:pointer;
            font-size:1.2rem;
            display:flex;
            align-items:center;
            justify-content:center;
        }
        .remove-btn{
            background:var(--danger);
            border:none;
            color:#fff;
            width:28px;
            height:28px;
            border-radius:6px;
            cursor:pointer;
        }
        .cart-summary{
            border-top:2px solid var(--border);
            padding-top:1rem;
            margin-top:0.5rem;
        }
        .total-price{
            color:var(--primary);
            font-size:1.6rem;
            font-weight:800;
        }
        .cart-actions{
            display:flex;
            gap:10px;
            margin-top:1rem;
        }
        .btn-clear{
            background:var(--danger);
            color:#fff;
            border:none;
            border-radius:12px;
            padding:0.8rem;
            flex:1;
            font-weight:600;
            cursor:pointer;
        }
        .btn-pay{
            background:transparent;
            border:2px solid var(--warning);
            color:var(--warning);
            border-radius:12px;
            padding:0.8rem;
            flex:1;
            text-align:center;
            text-decoration:none;
            font-weight:600;
        }
        /* ===== محتوای اصلی صفحه پرداخت ===== */
        .main-content{
            margin-top:100px;
            padding:2rem;
            min-height:80vh;
        }
        .container{
            max-width:1200px;
            margin:0 auto;
            padding:0 1rem;
        }
        .checkout-card{
            background:var(--bg-card);
            border:2px solid var(--primary);
            border-radius:40px;
            padding:3rem;
            box-shadow:var(--shadow);
        }
        .checkout-header{
            text-align:center;
            margin-bottom:3rem;
        }
        .checkout-header h1{
            font-size:2.5rem;
            color:var(--primary);
            margin-bottom:0.5rem;
        }
        .checkout-grid{
            display:grid;
            grid-template-columns:1.5fr 1fr;
            gap:2rem;
        }
        .form-section{
            background:#0d0f0e;
            border-radius:30px;
            padding:2rem;
        }
        .form-section h2{
            color:var(--primary);
            margin-bottom:2rem;
            font-size:1.8rem;
        }
        .form-group{
            margin-bottom:1.5rem;
        }
        .form-group label{
            display:block;
            margin-bottom:0.5rem;
            color:var(--text-muted);
        }
        .form-control{
            width:100%;
            padding:1rem 1.5rem;
            background:var(--bg-card);
            border:2px solid var(--border);
            border-radius:30px;
            color:#fff;
            font-size:1rem;
            outline:none;
            transition:0.3s;
        }
        .form-control:focus{
            border-color:var(--primary);
        }
        .password-field{
            position:relative;
        }
        .password-field input{
            padding-left:3rem;
        }
        .password-toggle{
            position:absolute;
            left:1rem;
            top:50%;
            transform:translateY(-50%);
            color:var(--text-muted);
            cursor:pointer;
        }
        .summary-section{
            background:#0d0f0e;
            border-radius:30px;
            padding:2rem;
            position:sticky;
            top:120px;
        }
        .summary-section h2{
            color:var(--primary);
            margin-bottom:2rem;
            font-size:1.8rem;
        }
        .summary-items{
            max-height:300px;
            overflow-y:auto;
            margin-bottom:1.5rem;
        }
        .summary-item{
            display:flex;
            justify-content:space-between;
            padding:1rem 0;
            border-bottom:1px solid var(--border);
        }
        .summary-item:last-child{
            border-bottom:none;
        }
        .item-name{
            flex:2;
        }
        .item-price{
            color:var(--primary);
            font-weight:600;
        }
        .total-row{
            display:flex;
            justify-content:space-between;
            margin:1rem 0;
            padding:1rem 0;
            border-top:2px solid var(--border);
            font-size:1.3rem;
        }
        .grand-total{
            color:var(--primary);
            font-weight:800;
            font-size:1.8rem;
        }
        .btn-paynow{
            background:linear-gradient(145deg,var(--primary),var(--primary-dark));
            color:#fff;
            border:none;
            padding:1.2rem;
            width:100%;
            border-radius:50px;
            font-size:1.2rem;
            font-weight:700;
            cursor:pointer;
            transition:0.3s;
            margin-top:1.5rem;
        }
        .btn-paynow:hover{
            transform:translateY(-3px);
            box-shadow:var(--shadow);
        }
        .secure-badge{
            display:flex;
            align-items:center;
            justify-content:center;
            gap:10px;
            margin-top:1.5rem;
            color:var(--text-muted);
        }
        /* ===== فوتر ===== */
        .footer{
            background:#050606;
            border-top:4px solid var(--primary-dark);
            padding:4rem 2rem 2rem;
            margin-top:5rem;
        }
        .footer a{
            color:#b0b0b0;
            text-decoration:none;
            transition:0.3s;
            line-height:2.2;
        }
        .footer a:hover{
            color:var(--primary);
            padding-right:8px;
        }
        .social-btn{
            border:2px solid var(--primary);
            border-radius:50%;
            width:50px;
            height:50px;
            display:flex;
            align-items:center;
            justify-content:center;
            color:var(--primary);
            transition:0.3s;
        }
        .social-btn:hover{
            background:var(--primary);
            color:#fff;
            transform:translateY(-5px);
        }
        /* ===== ریسپانسیو ===== */
        @media (max-width:992px){
            .nav-menu{
                display:none;
            }
            .hamburger{
                display:flex;
            }
            .search-box{
                width:180px;
            }
            .checkout-grid{
                grid-template-columns:1fr;
            }
            .summary-section{
                position:static;
            }
        }
        @media (max-width:768px){
            .navbar{
                padding:0.8rem 1rem;
            }
            .navbar-brand{
                font-size:1.5rem;
            }
            .nav-tools{
                gap:0.5rem;
            }
            .search-box{
                width:140px;
            }
            .cart-wrapper{
                left:10px;
                width:95%;
                max-width:360px;
            }
            .checkout-card{
                padding:1.5rem;
            }
        }
        @media (max-width:480px){
            .search-box{
                display:none;
            }
        }
    </style>
</head>
<body>
    <!-- ناوبری اصلی -->
    <nav class="navbar">
        <a class="navbar-brand" href="index.html"><i class="fa fa-store"></i> ارزان‌کالا</a>
        
        <ul class="nav-menu">
            <li class="nav-item"><a class="nav-link" href="index.html"><i class="fa fa-home"></i> خانه</a></li>
            <li class="nav-item"><a class="nav-link" href="category.html"><i class="fa fa-store"></i> محصولات</a></li>
            <li class="nav-item"><a class="nav-link" href="choose.html"><i class="fa fa-robot"></i> پیشنهاد</a></li>
            <li class="nav-item"><a class="nav-link" href="compare.html"><i class="fa fa-balance-scale"></i> مقایسه <span class="badge" id="compareCountDesktop">0</span></a></li>
            <li class="nav-item dropdown">
                <a class="nav-link" href="#"><i class="fa fa-bars"></i> دسته‌بندی</a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="category.html?category=mobile"><i class="fa fa-mobile-alt"></i> موبایل</a>
                    <a class="dropdown-item" href="category.html?category=laptop"><i class="fa fa-laptop"></i> لپ تاپ</a>
                    <a class="dropdown-item" href="category.html?category=accessory"><i class="fa fa-headphones"></i> لوازم جانبی</a>
                </div>
            </li>
        </ul>

        <div class="nav-tools">
            <div class="search-box">
                <form onsubmit="event.preventDefault();window.location='category.html?search='+encodeURIComponent(this.querySelector('input').value)">
                    <input type="text" placeholder="جستجو...">
                    <button type="submit"><i class="fa fa-search"></i></button>
                </form>
            </div>
            <button class="cart-btn" id="cartToggleBtn">
                <i class="fa fa-shopping-cart"></i>
                <span class="badge" id="cartTotal">0</span>
            </button>
            <a href="register.html" class="login-btn"><i class="fa fa-user"></i></a>
            <button class="hamburger" id="hamburgerBtn"><i class="fa fa-bars"></i></button>
        </div>
    </nav>

    <!-- منوی موبایل -->
    <div class="mobile-menu" id="mobileMenu">
        <a class="nav-link" href="index.html"><i class="fa fa-home"></i> خانه</a>
        <a class="nav-link" href="category.html"><i class="fa fa-store"></i> محصولات</a>
        <a class="nav-link" href="choose.html"><i class="fa fa-robot"></i> پیشنهاد</a>
        <a class="nav-link" href="compare.html"><i class="fa fa-balance-scale"></i> مقایسه <span class="badge" id="compareCountMobile">0</span></a>
        <div class="dropdown">
            <a class="nav-link" href="#"><i class="fa fa-bars"></i> دسته‌بندی</a>
            <div class="dropdown-menu">
                <a class="dropdown-item" href="category.html?category=mobile">موبایل</a>
                <a class="dropdown-item" href="category.html?category=laptop">لپ تاپ</a>
                <a class="dropdown-item" href="category.html?category=accessory">لوازم جانبی</a>
            </div>
        </div>
    </div>

    <!-- سبد خرید کشویی -->
    <div class="cart-wrapper" id="cartMenu">
        <div class="cart">
            <div class="cart-header"><h3><i class="fa fa-shopping-cart"></i> سبد خرید</h3></div>
            <div class="cart-body" id="cartItems"></div>
            <div style="padding:1.2rem;padding-top:0;">
                <div class="cart-summary">
                    <div class="d-flex justify-between align-center">
                        <span style="font-size:1.2rem;">مجموع:</span>
                        <span class="total-price" id="cartTotalPrice">0</span>
                        <span>تومان</span>
                    </div>
                    <div class="cart-actions">
                        <button class="btn-clear" id="clearCartBtn"><i class="fa fa-trash"></i> حذف همه</button>
                        <a href="buy.html" class="btn-pay" id="payBtn"><i class="fa fa-credit-card"></i> پرداخت</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- محتوای اصلی صفحه پرداخت -->
    <div class="main-content">
        <div class="container">
            <div class="checkout-card">
                <div class="checkout-header">
                    <h1><i class="fa fa-shield-alt"></i> درگاه پرداخت امن</h1>
                    <p class="text-muted">اطلاعات خود را وارد کنید</p>
                </div>

                <div class="checkout-grid">
                    <div class="form-section">
                        <h2>اطلاعات شخصی</h2>
                        <form id="paymentForm">
                            <div class="form-group">
                                <label>نام و نام خانوادگی</label>
                                <input type="text" class="form-control" placeholder="علی محمدی" id="fullName">
                            </div>
                            <div class="form-group">
                                <label>شماره موبایل</label>
                                <input type="text" class="form-control" placeholder="09123456789" id="mobile">
                            </div>
                            <div class="form-group">
                                <label>ایمیل</label>
                                <input type="email" class="form-control" placeholder="info@example.com" id="email">
                            </div>
                            <div class="form-group">
                                <label>نام کاربری</label>
                                <input type="text" class="form-control" placeholder="نام کاربری" id="username">
                            </div>
                            <div class="form-group password-field">
                                <label>رمز عبور</label>
                                <input type="password" class="form-control" placeholder="********" id="password">
                                <i class="fa fa-eye password-toggle" id="togglePassword"></i>
                            </div>
                        </form>
                    </div>

                    <div class="summary-section">
                        <h2>خلاصه سفارش</h2>
                        <div class="summary-items" id="orderItems"></div>
                        <div class="total-row">
                            <span>جمع کل:</span>
                            <span class="grand-total" id="totalAmount">0</span>
                        </div>
                        <span style="color:var(--text-muted);">تومان</span>
                        <button class="btn-paynow" id="payNowBtn">
                            <i class="fa fa-credit-card"></i> پرداخت
                        </button>
                        <div class="secure-badge">
                            <i class="fa fa-lock"></i>
                            <span>پرداخت امن و رمزنگاری شده</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- فوتر -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col">
                    <h4 style="color:var(--primary);margin-bottom:1.5rem;">ارزان کالا</h4>
                    <p>فروشگاه آنلاین با 10 سال سابقه درخشان. اصالت کالا تضمینی، ارسال اکسپرس به سراسر ایران.</p>
                </div>
                <div class="col">
                    <h4 style="color:var(--primary);margin-bottom:1.5rem;">لینک‌های مفید</h4>
                    <a href="#">درباره ما</a><br>
                    <a href="#">تماس با ما</a><br>
                    <a href="#">قوانین</a>
                </div>
                <div class="col">
                    <h4 style="color:var(--primary);margin-bottom:1.5rem;">دسته‌بندی‌ها</h4>
                    <a href="category.html?category=mobile">موبایل</a><br>
                    <a href="category.html?category=laptop">لپ تاپ</a><br>
                    <a href="category.html?category=accessory">لوازم جانبی</a>
                </div>
                <div class="col">
                    <h4 style="color:var(--primary);margin-bottom:1.5rem;">ارتباط با ما</h4>
                    <p><i class="fa fa-map-marker"></i> تهران، ولیعصر</p>
                    <p><i class="fa fa-phone"></i> ۰۲۱-۱۲۳۴۵۶۷۸</p>
                </div>
            </div>
            <hr style="border-color:#2a2f2e;margin:2rem 0;">
            <div class="d-flex justify-between align-center flex-wrap" style="gap:1rem;">
                <div class="d-flex gap-2">
                    <a href="#" class="social-btn"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-btn"><i class="fab fa-telegram"></i></a>
                    <a href="#" class="social-btn"><i class="fab fa-whatsapp"></i></a>
                </div>
                <p>کلیه حقوق برای فروشگاه ارزان کالا محفوظ است - ۱۴۰۴</p>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
    <script>
        (function(){
            // ================== سبد خرید و مقایسه ==================
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let compareList = JSON.parse(localStorage.getItem('compareList')) || [];

            function updateAllBadges(){
                const cartCount = cart.reduce((sum,i)=>sum+(i.qty||1),0);
                document.querySelectorAll('#cartTotal, #cartTotalMobile').forEach(el=>{if(el) el.textContent=cartCount;});
                const compareCount = compareList.length;
                document.querySelectorAll('#compareCountDesktop, #compareCountMobile').forEach(el=>{if(el) el.textContent=compareCount;});
                
                const totalPrice = cart.reduce((sum,i)=>sum+(i.price*(i.qty||1)),0);
                const priceEl = document.getElementById('cartTotalPrice');
                if(priceEl) priceEl.textContent = totalPrice.toLocaleString();

                const cartDiv = document.getElementById('cartItems');
                if(cartDiv){
                    if(cart.length===0){
                        cartDiv.innerHTML = '<div class="text-center" style="padding:2rem;">سبد خرید خالی است</div>';
                    }else{
                        let html = '';
                        cart.forEach(item=>{
                            html += `<div class="cart-item">
                                <img src="img/${item.image}" onerror="this.src='https://via.placeholder.com/60'">
                                <div class="cart-item-info">
                                    <div class="cart-item-name">${item.name}</div>
                                    <div class="cart-item-price">${item.price.toLocaleString()} تومان</div>
                                    <div class="cart-qty">
                                        <button class="qty-btn" onclick="window.changeQty(${item.id}, -1)">-</button>
                                        <span>${item.qty||1}</span>
                                        <button class="qty-btn" onclick="window.changeQty(${item.id}, 1)">+</button>
                                        <button class="remove-btn" onclick="window.removeFromCart(${item.id})"><i class="fa fa-trash"></i></button>
                                    </div>
                                </div>
                            </div>`;
                        });
                        cartDiv.innerHTML = html;
                    }
                }
            }

            window.addToCart = (product)=>{
                const exist = cart.find(i=>i.id===product.id);
                if(exist) exist.qty = (exist.qty||1)+1;
                else cart.push({...product, qty:1});
                localStorage.setItem('cart', JSON.stringify(cart));
                updateAllBadges();
                alert('✅ محصول به سبد خرید اضافه شد');
            };

            window.changeQty = (id, delta)=>{
                const idx = cart.findIndex(i=>i.id===id);
                if(idx===-1) return;
                if(delta===-1 && cart[idx].qty>1) cart[idx].qty--;
                else if(delta===-1) cart.splice(idx,1);
                else if(delta===1) cart[idx].qty = (cart[idx].qty||1)+1;
                localStorage.setItem('cart',JSON.stringify(cart));
                updateAllBadges();
            };

            window.removeFromCart = (id)=>{
                cart = cart.filter(i=>i.id!==id);
                localStorage.setItem('cart',JSON.stringify(cart));
                updateAllBadges();
            };

            document.getElementById('clearCartBtn')?.addEventListener('click',()=>{
                if(confirm('همه آیتم‌ها حذف شوند؟')){
                    cart = [];
                    localStorage.setItem('cart',JSON.stringify(cart));
                    updateAllBadges();
                }
            });

            // ================== منوی همبرگر ==================
            const hamburger = document.getElementById('hamburgerBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            if(hamburger && mobileMenu){
                hamburger.addEventListener('click',()=>{
                    mobileMenu.classList.toggle('active');
                });
            }

            // ================== سبد خرید کشویی ==================
            const cartBtn = document.getElementById('cartToggleBtn');
            const cartMenu = document.getElementById('cartMenu');
            if(cartBtn && cartMenu){
                cartBtn.addEventListener('click',(e)=>{
                    e.stopPropagation();
                    cartMenu.classList.toggle('active');
                    mobileMenu.classList.remove('active');
                });
                document.addEventListener('click',(e)=>{
                    if(!cartMenu.contains(e.target) && !cartBtn.contains(e.target)){
                        cartMenu.classList.remove('active');
                    }
                });
            }

            // ================== نمایش خلاصه سفارش ==================
            const orderItems = document.getElementById('orderItems');
            const totalAmount = document.getElementById('totalAmount');

            function displayOrderSummary(){
                if(cart.length === 0){
                    orderItems.innerHTML = '<p class="text-center" style="padding:2rem;">سبد خرید خالی است</p>';
                    totalAmount.textContent = '0';
                    return;
                }

                let html = '';
                let total = 0;
                cart.forEach(item => {
                    const itemTotal = item.price * (item.qty || 1);
                    total += itemTotal;
                    html += `
                        <div class="summary-item">
                            <span class="item-name">${item.name} × ${item.qty||1}</span>
                            <span class="item-price">${itemTotal.toLocaleString()} تومان</span>
                        </div>
                    `;
                });
                orderItems.innerHTML = html;
                totalAmount.textContent = total.toLocaleString();
            }

            displayOrderSummary();

            // ================== دکمه پرداخت ==================
            document.getElementById('payNowBtn').addEventListener('click', function(){
                if(cart.length === 0){
                    alert('سبد خرید شما خالی است');
                    return;
                }

                const fullName = document.getElementById('fullName').value.trim();
                const mobile = document.getElementById('mobile').value.trim();
                const email = document.getElementById('email').value.trim();
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value;

                if(!fullName || !mobile || !email || !username || !password){
                    alert('لطفاً تمام اطلاعات را وارد کنید');
                    return;
                }

                // شبیه‌سازی پرداخت
                alert('✅ به درگاه بانک متصل می‌شوید...');
                // در پروژه واقعی، به صفحه درگاه هدایت می‌شود
            });

            // ================== نمایش/پنهان کردن رمز عبور ======